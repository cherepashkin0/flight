2025-09-26 17:16:34,069 [INFO] === Starting ML Pipeline ===
2025-09-26 17:16:34,074 [INFO] Columns to skip from config: ['DivAirportLandings', 'DepartureDelayGroups', 'AirTime', 'ArrivalDelayGroups', 'ArrDelay', 'ArrDelayMinutes', 'DepDelay', 'DepDelayMinutes', 'ActualElapsedTime', 'TaxiOut', 'TaxiIn', 'Diverted', '__index_level_0__', 'DepDel15', 'ArrDel15']
2025-09-26 17:16:34,074 [INFO] Filtered out 13 columns. Using 16 numeric features.
2025-09-26 17:16:34,078 [INFO] Actually skipped numeric columns: ['DivAirportLandings', 'DepartureDelayGroups', 'AirTime', 'ArrivalDelayGroups', 'ArrDelay', 'ArrDelayMinutes', 'DepDelay', 'DepDelayMinutes', 'ActualElapsedTime', 'TaxiOut', 'TaxiIn', 'Diverted', '__index_level_0__']
2025-09-26 17:16:34,078 [INFO] Using 16 numeric features after filtering skip_additional columns
2025-09-26 17:16:34,082 [INFO] Columns→roles mapping (used): {'OriginAirportID': 'num', 'DestCityMarketID': 'num', 'DestStateFips': 'num', 'DOT_ID_Marketing_Airline': 'num', 'OriginAirportSeqID': 'num', 'Cancelled': 'tgt', 'OriginWac': 'num', 'DestAirportID': 'num', 'CRSElapsedTime': 'num', 'DOT_ID_Operating_Airline': 'num', 'Distance': 'num', 'DayofMonth': 'num', 'OriginCityMarketID': 'num', 'DestAirportSeqID': 'num', 'OriginStateFips': 'num', 'Flight_Number_Operating_Airline': 'num', 'Flight_Number_Marketing_Airline': 'num'}
2025-09-26 17:16:34,150 [INFO] Loading data from BigQuery...
2025-09-26 17:16:37,332 [INFO] Loaded data shape: (10000, 17)
2025-09-26 17:16:37,346 [INFO] Train set: (8000, 16), Test set: (2000, 16)
2025-09-26 17:16:37,346 [INFO] Starting Optuna optimization...
2025-09-26 17:16:38,266 [INFO] Best parameters: {'num_leaves': 55, 'learning_rate': 0.029227213972267338, 'max_depth': 4, 'min_data_in_leaf': 79}
2025-09-26 17:16:38,266 [INFO] Best F2 score: 0.5089
2025-09-26 17:16:38,406 [INFO] Default threshold (0.5) F2: 0.0075
2025-09-26 17:16:38,406 [INFO] Optimized threshold (0.200) F2: 0.7171
2025-09-26 17:16:39,284 [INFO] Saved columns→roles mapping locally: /home/sevas1saves/flight/mycoding/columns_roles.json
2025-09-26 17:16:39,473 [INFO] Model logged to MLflow with F2 score: 0.7171
2025-09-26 17:16:39,473 [INFO] Model URI: gs://mlflow_flight_cancellation3/artifacts/1/edf982afbefc4c0eba4db2d1d044d2b7/artifacts/model.joblib
2025-09-26 17:16:39,473 [INFO] Feature importances URI: gs://mlflow_flight_cancellation3/artifacts/1/edf982afbefc4c0eba4db2d1d044d2b7/artifacts/feature_importances.csv
2025-09-26 17:16:39,473 [INFO] Roles mapping URI: gs://mlflow_flight_cancellation3/artifacts/1/edf982afbefc4c0eba4db2d1d044d2b7/artifacts/columns_roles.json
2025-09-26 17:16:39,473 [INFO] Model metadata URI: gs://mlflow_flight_cancellation3/artifacts/1/edf982afbefc4c0eba4db2d1d044d2b7/artifacts/model_metadata.json
2025-09-26 17:16:39,473 [INFO] Top 5 features: ['DayofMonth', 'Flight_Number_Operating_Airline', 'Distance', 'DOT_ID_Marketing_Airline', 'OriginWac']
2025-09-26 17:16:39,851 [INFO] Metrics logged to BigQuery successfully
2025-09-26 17:16:39,851 [INFO] === Pipeline completed successfully ===
